<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="test.dao.UserMapper">

	<select id="getUser" resultType="com.xiongyx.User">
		select * from user
		<where>

<!--			<if test="__frch_item_0 != null">and id = #{__frch_item_0}</if>-->


			<if test="idListQuery != null">
				and id in
				<foreach collection="idListQuery" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>

			<if test="idListQuery != null">
				and id in
				<foreach collection="idListQuery" index="index" item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>


			<if test="id != null">and id = #{id}</if>
			<if test="age != null">and age = #{age}</if>
			<if test="money != null">and money = #{money}</if>
		</where>
	</select>



	<resultMap id="getUserLinkedQueryMap" type="com.xiongyx.User">
		<id column="id" property="id"/>
		<result column="userName" property="userName"/>
		<result column="age" property="age"/>
		<result column="money" property="money"/>

		<association property="account" javaType="com.xiongyx.Account">
			<id column="accountId" property="id"/>
			<result column="password" property="password"/>
		</association>

		<collection property="bookList" ofType="com.xiongyx.Book">
			<id column="bookId" property="id"/>
			<result column="book_name" property="bookName"/>
			<result column="author_id" property="authorId"/>
			<result column="price" property="price"/>
		</collection>
	</resultMap>


	<select id="getUserLinkedQuery" resultMap="getUserLinkedQueryMap">
		select
			`user`.id,
			userName,
			age,
			money,
			test_book.id as 'bookId',
			book_name,
			author_id,
			price
 		from user inner join test_book
 		on `user`.id = test_book.author_id
	</select>

	<select id="result_map_test" resultMap="getUserLinkedQueryMap">
		select * from result_map_test
	</select>

	<update id="updateUser">
		update user
		<set>
			<if test="name != null">name = '张三2'</if>
		</set>
		where id = #{id}
	</update>
	
</mapper>